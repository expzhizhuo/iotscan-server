import{r as C,_ as G,u as F,U as O}from"./index-2c25bdbe.js";/* empty css               *//* empty css               *//* empty css                    *//* empty css                */import{H as S,_ as R}from"./NetworkEcharts.vue_vue_type_script_setup_true_lang-a8f6871d.js";import{a as I,p as N,q as V,r as A,u as T,s as j,t as q,d as K,v as Z,e as J}from"./element-deea76d4.js";import{H as P,a as k,E as H,Z as Q,l as r,m as u,V as t,P as o,p as e,U as s,F as U,a8 as B,S as D,ay as L,az as M,K as W,u as h,T as m}from"./vue-657d2c67.js";const w=d=>(L("data-v-76f82d3e"),d=d(),M(),d),X={class:"status-info"},Y={class:"cpu-echarts"},ee=w(()=>e("p",{class:"cpu-usage-label"},"当前cpu使用率",-1)),te={class:"memory-main"},oe=w(()=>e("h4",{class:"info-header"},"内存信息",-1)),se={class:"disk-main"},ae=w(()=>e("h4",{class:"info-header"},"磁盘信息",-1)),ne={class:"process-main"},ce=w(()=>e("h4",{class:"info-header"},"进程信息",-1)),le={class:"network-main"},_e=w(()=>e("h4",{class:"info-header"},"设备网卡信息",-1)),de={class:"network-info-container"},ie={key:0},re={key:1},ue=P({__name:"CpuEcharts",setup(d){const y=k({count:0,list:[{name:"",ipv4:"",ipv6:[],mac:""}]}),c=k({cpu_usage:0,memory_size:0,memory_free_size:0,memory_usage:0,disk_size:0,disk_free_size:0,disk_usage:0,network_count:0,process_count:0}),$=k([]);H(()=>{S.get_device_network().then(l=>{l.data.code==200?y.value=l.data.data:(I.error(l.data.msg||"服务器异常"),C.push("/login"))});const n=setInterval(()=>{S.get_device_status().then(l=>{l.data.code==200?c.value=l.data.data:(I.error(l.data.msg||"服务器异常"),C.push("/login"))})},1e3);$.value.push(n)}),Q(()=>{for(const n of $.value)clearInterval(n)});const v=[{color:"#1989fa",percentage:20},{color:"#5cb87a",percentage:40},{color:"#fcc000",percentage:60},{color:"#fa7e19",percentage:80},{color:"#ff0000",percentage:100}];return(n,l)=>{const b=N,a=V,g=A;return r(),u("div",X,[t(g,{gutter:20},{default:o(()=>[t(a,{span:6},{default:o(()=>[e("div",Y,[t(b,{type:"dashboard",percentage:c.value.cpu_usage,color:v,"stroke-width":12,width:150},null,8,["percentage"]),ee])]),_:1}),t(a,{span:5},{default:o(()=>[e("div",te,[oe,e("p",null,"当前使用："+s(c.value.memory_usage)+" G",1),e("p",null,"空闲："+s(c.value.memory_free_size)+" G",1),e("p",null,"总共："+s(c.value.memory_size)+" G",1)])]),_:1}),t(a,{span:5},{default:o(()=>[e("div",se,[ae,e("p",null,"当前使用："+s(c.value.disk_usage)+" G",1),e("p",null,"空闲："+s(c.value.disk_free_size)+" G",1),e("p",null,"总共："+s(c.value.disk_size)+" G",1)])]),_:1}),t(a,{span:5},{default:o(()=>[e("div",ne,[ce,e("p",null,"正在运行进程："+s(c.value.process_count)+" 个",1)])]),_:1})]),_:1}),e("div",le,[_e,e("div",de,[(r(!0),u(U,null,B(y.value.list,_=>(r(),u("div",{key:_.name,class:"network-info"},[e("span",null,"网卡："+s(_.name),1),_.ipv4?(r(),u("span",ie,"ipv4地址："+s(_.ipv4),1)):D("",!0),_.ipv6.length>0?(r(),u("span",re,[(r(!0),u(U,null,B(_.ipv6,(i,f)=>(r(),u("span",{key:f},"ipv6地址："+s(i),1))),128))])):D("",!0),e("span",null,"mac地址："+s(_.mac),1)]))),128))])])])}}});const pe=G(ue,[["__scopeId","data-v-76f82d3e"]]),x=d=>(L("data-v-1a7fa1a7"),d=d(),M(),d),he={class:"user-info"},ve={style:{"font-size":"70px","font-weight":"bold"}},ge={class:"user-info-cont"},fe={class:"user-info-name"},me={class:"user-info-list"},ye={class:"user-info-list"},ke=x(()=>e("div",{class:"clearfix"},[e("span",null,"POC详情")],-1)),we={class:"grid-content grid-con-1"},xe={class:"grid-cont-right"},$e={class:"grid-num"},Ce=x(()=>e("div",null,"任务数量",-1)),Ie={class:"grid-content grid-con-2"},be={class:"grid-cont-right"},ze={class:"grid-num"},Ee=x(()=>e("div",null,"POC数量",-1)),Se={class:"grid-content grid-con-3"},Ue={class:"grid-cont-right"},Be={class:"grid-num"},De=x(()=>e("div",null,"漏洞数量",-1)),Ge=x(()=>e("h1",null,"系统信息",-1)),Ne=P({__name:"DashBoard",setup(d){const y=F(),c=y.getUserName(),$=y.getRoles(),v=k({username:"",permissions:0,phone:null,last_login:"",last_login_ip:""}),n=k({count:{task_count:{task_count_total:0,task_count_running:0,task_count_finish:0,task_count_error:0},poc_count:{poc_total:0,poc_critical:0,poc_high:0,poc_middle:0,poc_low:0}},poc_attack_success:0});H(()=>{S.get_home_info().then(a=>{a.data.code==200?n.value=a.data.data:(I.error(a.data.msg||"服务器异常"),C.push("/login"))}),O.getUserInfo().then(a=>{a.data.code==200?v.value=a.data.data:(I.error(a.data.msg||"服务器异常"),C.push("/login"))})});const l=a=>Math.round(a*1e4)/100,b=a=>{let g=[];g.push("#");for(let _=0;_<a.length;_++)g.push(parseInt(a[_].charCodeAt(0),10).toString(16));return g.slice(0,5).join("").slice(0,4)};return(a,g)=>{const _=K,i=Z,f=N,p=V,z=J,E=A;return r(),u("div",null,[t(E,{gutter:20},{default:o(()=>[t(p,{span:8},{default:o(()=>[t(i,{shadow:"hover",class:"mgb20",style:{height:"252px"}},{default:o(()=>[e("div",he,[t(_,{size:120,style:W(`background:${b(h(c))}`)},{default:o(()=>[e("span",ve,s(h(c)[0].toUpperCase()),1)]),_:1},8,["style"]),e("div",ge,[e("div",fe,s(h(c)||v.value.username),1),e("div",null,s(h($)),1)])]),e("div",me,[m(" 当前登录时间： "),e("span",null,s(v.value.last_login),1)]),e("div",ye,[m(" 当前登录ip地址： "),e("span",null,s(v.value.last_login_ip),1)])]),_:1}),t(i,{shadow:"hover",style:{height:"252px"}},{header:o(()=>[ke]),default:o(()=>[m(" 严重 "),t(f,{percentage:l(n.value.count.poc_count.poc_critical/n.value.count.poc_count.poc_total)||0,color:"#42b983",striped:!0},null,8,["percentage"]),m(" 高危 "),t(f,{percentage:l(n.value.count.poc_count.poc_high/n.value.count.poc_count.poc_total)||0,color:"#f1e05a",striped:!0},null,8,["percentage"]),m(" 中危 "),t(f,{percentage:l(n.value.count.poc_count.poc_middle/n.value.count.poc_count.poc_total)||0,striped:!0},null,8,["percentage"]),m(" 低危 "),t(f,{percentage:l(n.value.count.poc_count.poc_low/n.value.count.poc_count.poc_total)||0,color:"#f56c6c",striped:!0},null,8,["percentage"])]),_:1})]),_:1}),t(p,{span:16},{default:o(()=>[t(E,{gutter:20,class:"mgb20"},{default:o(()=>[t(p,{span:8},{default:o(()=>[t(i,{shadow:"hover","body-style":{padding:"0px"}},{default:o(()=>[e("div",we,[t(z,{class:"grid-con-icon"},{default:o(()=>[t(h(T))]),_:1}),e("div",xe,[e("div",$e,s(n.value.count.task_count.task_count_total),1),Ce])])]),_:1})]),_:1}),t(p,{span:8},{default:o(()=>[t(i,{shadow:"hover","body-style":{padding:"0px"}},{default:o(()=>[e("div",Ie,[t(z,{class:"grid-con-icon"},{default:o(()=>[t(h(j))]),_:1}),e("div",be,[e("div",ze,s(n.value.count.poc_count.poc_total),1),Ee])])]),_:1})]),_:1}),t(p,{span:8},{default:o(()=>[t(i,{shadow:"hover","body-style":{padding:"0px"}},{default:o(()=>[e("div",Se,[t(z,{class:"grid-con-icon"},{default:o(()=>[t(h(q))]),_:1}),e("div",Ue,[e("div",Be,s(n.value.poc_attack_success),1),De])])]),_:1})]),_:1}),t(p,{style:{"margin-top":"20px"}},{default:o(()=>[t(i,{shadow:"hover","body-style":{padding:"0,20px"}},{default:o(()=>[t(R)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(E,{gutter:20},{default:o(()=>[t(p,null,{default:o(()=>[t(i,{shadow:"hover"},{default:o(()=>[e("div",null,[Ge,e("div",null,[t(pe)])])]),_:1})]),_:1})]),_:1})])}}});const Re=G(Ne,[["__scopeId","data-v-1a7fa1a7"]]);export{Re as default};
