import{s as v,u as M,_ as j}from"./index-2c25bdbe.js";/* empty css               *//* empty css                 */import{T as G}from"./TablesView-b69a0b48.js";import{H as J,aA as X,ax as F,A as K,a as k,_ as Q,$ as W,b as Y,m as Z,p as h,V as _,P as l,O as x,S,u as z,l as C,T as d,U as P}from"./vue-657d2c67.js";import{b as T,a as p,G as ee,w as te,m as ae,H as oe}from"./element-deea76d4.js";/* empty css                    */const se=[{prop:"poc_name",label:"漏洞名称",showOverflowTooltip:!0},{prop:"vul_desc",label:"漏洞描述",showOverflowTooltip:!0},{prop:"vul_author",label:"作者",showOverflowTooltip:!0},{prop:"vul_leakLevel",label:"漏洞等级",slot:"vul_leakLevel",sortable:!0,width:"120px"},{prop:"vul_name",label:"影响产品",showOverflowTooltip:!0},{prop:"vul_range",label:"影响版本",showOverflowTooltip:!0},{prop:"has_exp",label:"有无EXP",slot:"has_exp",width:"80px"},{prop:"vul_vulDate",label:"公布日期"},{type:"date",prop:"vul_createDate",label:"编写日期"},{width:"180",label:"操作",buttons:[],slot:"action"}],f={get_poc_list(g){return v({url:"/tools/poc_list",method:"get",params:g})},get_poc_list_search(g){return v({url:"/tools/poc_list/search",headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"post",data:g})},get_poc_init(){return v({url:"/tools/poc_list",method:"post"})},delete_poc(g){return v({url:"/tools/poc_list/delete_poc",method:"post",data:g})}},le={class:"poc_search"},ne=J({__name:"PocListView",setup(g){const n=X(),m=F(),c=K("reload"),i=k(),L=M(),y=k(!1);L.getPermiss()=="1"&&(y.value=!0),n.query.search&&(i.value=n.query.search);const a={page:Number(n.query.page)||1,pageSize:Number(n.query.pageSize)||10,search:String(n.query.search)||""},b=Q({tableDemoList:[],options:{showPagination:!0}}),{options:O}=W(b),w=k([]),V=(e,t,o)=>{switch(e){case"edit":alert("点击了编辑");break;case"delete":T.confirm("确认删除吗？","提示").then(()=>{p(JSON.stringify(t))}).catch(()=>null);break}},q=async(e,t,o=a.search)=>{await m.push({path:n.path,query:{page:e,pageSize:t,search:o}}),c()},N=()=>{i.value,i.value?m.push({path:n.path,query:{page:1,pageSize:10,search:i.value}}):(p.error("请输入搜索内容"),c())},B=async()=>{i.value="",await m.push({path:n.path,query:{page:1,pageSize:10,search:""}}),c()},E=()=>{const e=ee.service({lock:!0,text:"正在初始化POC信息，请忽刷新或关闭页面，请耐心等待。",background:"rgba(0, 0, 0, 0.7)"});I().then(t=>{e.close(),t.data.code==200?(p.success(t.data.data.info),c()):(p.error(t.data.msg||"服务器异常"),m.push("/login"))})},D=e=>{T.confirm("是否删除此POC？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{f.delete_poc({poc_id:e.id}).then(t=>{t.data.code==200?(p.success(`删除POC${e.poc_name}成功`),c()):(p.error(`删除POC${e.poc_name}失败`),c())})}).catch(()=>{p({type:"info",message:"取消删除"}),c()})},$=e=>{p.success(`查看POC${e.id}内容`)},A=(e=1,t=10,o="")=>f.get_poc_list({id:o,page:e,page_size:t}),R=(e=1,t=10,o="")=>f.get_poc_list_search({keyword:o,page:e,page_size:t}),I=()=>f.get_poc_init();Y(()=>n.query,async e=>{const{page:t,pageSize:o,search:u}=e;a.page=Number(t)||a.page,a.pageSize=Number(o)||a.pageSize,a.search=u||"",a.search?R(a.page,a.pageSize,a.search).then(r=>{w.value=r.data.data.list,b.options.paginationConfig={total:r.data.data.total,currentPage:a.page,pageSize:a.pageSize,pageSizes:[10,50,100],layout:"total,prev, pager, next,sizes"}}):A(a.page,a.pageSize,a.search).then(r=>{w.value=r.data.data.list,b.options.paginationConfig={total:r.data.data.total,currentPage:a.page,pageSize:a.pageSize,pageSizes:[10,50,100],layout:"total,prev, pager, next,sizes"}})},{immediate:!0});const U=e=>({0:"提示",1:"低危",2:"中危",3:"高危",4:"严重"})[e];return(e,t)=>{const o=te,u=ae,r=oe;return C(),Z("div",null,[h("div",null,[h("div",le,[_(o,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s),placeholder:"请输入搜索内容",style:{width:"300px","margin-left":"10px"},clearable:""},null,8,["modelValue"]),_(u,{type:"primary",onClick:N,style:{"margin-left":"30px"}},{default:l(()=>[d("搜索")]),_:1}),_(u,{type:"primary",onClick:B},{default:l(()=>[d("重置")]),_:1}),y.value?(C(),x(u,{key:0,type:"primary",onClick:E},{default:l(()=>[d("初始化poc")]),_:1})):S("",!0)]),h("div",null,[_(G,{columns:z(se),"table-data":w.value,options:z(O),onPaginationChange:q,onCommand:V},{vul_leakLevel:l(({row:s})=>[h("span",null,[_(r,{type:{0:"",1:"success",2:"warning",3:"danger",4:"danger"}[s.vul_leakLevel]},{default:l(()=>[d(P(U(s.vul_leakLevel)),1)]),_:2},1032,["type"])])]),has_exp:l(({row:s})=>[h("span",null,[_(r,{type:{false:"info",true:"success"}[s.has_exp]},{default:l(()=>[d(P(s.has_exp?"有":"无"),1)]),_:2},1032,["type"])])]),action:l(({row:s})=>[h("div",null,[_(u,{type:"primary",onClick:H=>$(s)},{default:l(()=>[d("查看")]),_:2},1032,["onClick"]),y.value?(C(),x(u,{key:0,type:"danger",onClick:H=>D(s)},{default:l(()=>[d("删除")]),_:2},1032,["onClick"])):S("",!0)])]),_:1},8,["columns","table-data","options"])])])])}}});const ge=j(ne,[["__scopeId","data-v-c6edf7dc"]]);export{ge as default};
